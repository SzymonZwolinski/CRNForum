@page "/plate/list/worst"
@using Platender.Front.Services
@using Platender.Front.Models
<MudPaper>
    @foreach(var plate in Plates)
    {
        <Platender.Front.Components.EUPlate PlateId="@plate.Id" CultureCode="@plate.Culture" Number="@plate.Number"
								DisplayFlag="true" FlagSrc="images/EUFlagHD.jpg" OnClickAction="@MoveToPlate"></Platender.Front.Components.EUPlate>
    }
</MudPaper>

@code {
    [Inject]
	private NavigationManager _navigationManager { get; set; }
    [Inject]
    private IPlateService _plateService { get; set; }
    private List<Plate> Plates = new();
    private int page = 1;
    private int MaxPage;
    
    protected override async Task OnInitializedAsync()
    {
        var paggedPlates = await _plateService.GetListOfTopDislikedPlatesAsync(page, null);
        Plates.AddRange(paggedPlates.Items);
        
        MaxPage = (paggedPlates.TotalItems + 9) / 10;
        page++;
    }

    private void MoveToPlate(Guid plateId)
	{
		_navigationManager.NavigateTo("/plates/" + plateId.ToString());
	}
}
